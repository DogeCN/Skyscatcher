<!DOCTYPE html>
<html>

<head>
    <title>å›¾ç‰‡äº¤äº’æ•ˆæœé¢„è§ˆ - å¢å¼ºç‰ˆ</title>
    <style>
        body {
            margin: 0;
            background: #1e1e1e;
            color: #c0c0c0;
            font-family: Arial, sans-serif;
            font-size: 1.6em;
            line-height: 2.1;
            padding: 60px 8%;
            transition: all 0.3s ease;
        }

        h1,
        h2 {
            font-weight: 400;
            margin: 2em 0 1em 0;
            font-size: 1.6em;
        }

        h1 {
            font-size: 2.2em;
            margin-top: 1em;
            color: #e0e0e0;
        }

        h2 {
            color: #d0d0d0;
            border-left: 4px solid #555;
            padding-left: 15px;
        }

        p {
            margin: 1.2em 0;
        }

        .q {
            width: 30px;
            height: 30px;
        }

        .lz {
            width: 50%;
            height: auto;
            border-radius: 6px;
            transition: all 0.4s ease;
            transform-origin: center center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            cursor: pointer;
        }

        .lz.large {
            width: 90%;
            margin: 20px auto;
        }

        .lz:hover {
            opacity: 0.9;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.7);
        }

        .img-container {
            display: block;
            text-align: center;
            margin: 25px auto;
            overflow: visible;
            transition: all 0.4s ease;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 20px;
            background: #555;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background: #777;
            transform: translateY(-2px);
        }

        .btn-rotate {
            background: #3a6b8a;
        }

        .btn-rotate:hover {
            background: #4a8bb0;
        }

        .btn-zoom {
            background: #5a7a5a;
        }

        .btn-zoom:hover {
            background: #6b9a6b;
        }

        .btn-reset {
            background: #8a3a3a;
        }

        .btn-reset:hover {
            background: #b04a4a;
        }

        .status-bar {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 30px 0;
            padding: 15px;
            background: #2a2a2a;
            border-radius: 8px;
            flex-wrap: wrap;
        }

        .status-item {
            text-align: center;
            padding: 0 15px;
        }

        .status-label {
            font-size: 0.9em;
            color: #a0a0a0;
            margin-bottom: 5px;
        }

        .status-value {
            font-size: 1.1em;
            font-weight: bold;
            color: #e0e0e0;
        }

        .instructions {
            background: #2a2a2a;
            padding: 25px;
            border-radius: 8px;
            margin: 30px 0;
            border-left: 4px solid #555;
        }

        .instructions h3 {
            color: #d0d0d0;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .instructions ul {
            list-style-type: none;
            padding-left: 10px;
        }

        .instructions li {
            margin-bottom: 10px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .instructions li:before {
            content: "â€¢";
            color: #5a7a5a;
            font-weight: bold;
            font-size: 1.2em;
        }

        @media (max-width: 768px) {
            body {
                padding: 30px 5%;
                font-size: 1.4em;
            }

            .lz {
                width: 85%;
            }

            .lz.large {
                width: 95%;
            }

            .status-bar {
                flex-direction: column;
                gap: 15px;
            }

            .controls {
                flex-direction: column;
                align-items: center;
            }

            .btn {
                width: 100%;
                max-width: 300px;
            }
        }

        /* å¸ƒå±€è°ƒæ•´ */
        .layout-adjusted .img-container {
            margin: 35px auto;
        }

        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        /* æ—‹è½¬åŠ¨ç”» */
        @keyframes rotateContinuous {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        .rotating {
            animation: rotateContinuous 2s linear infinite;
        }
    </style>
</head>

<body>
    <h1>å›¾ç‰‡äº¤äº’æ•ˆæœæµ‹è¯• - å¢å¼ºç‰ˆ</h1>

    <div class="status-bar">
        <div class="status-item">
            <div class="status-label">å½“å‰æ¨¡å¼</div>
            <div class="status-value" id="currentMode">ç­‰å¾…æ“ä½œ</div>
        </div>
        <div class="status-item">
            <div class="status-label">æ—‹è½¬è§’åº¦</div>
            <div class="status-value" id="rotationAngle">0Â°</div>
        </div>
        <div class="status-item">
            <div class="status-label">ç¼©æ”¾çŠ¶æ€</div>
            <div class="status-value" id="zoomStatus">æ­£å¸¸</div>
        </div>
    </div>

    <div class="controls">
        <button class="btn btn-zoom" onclick="toggleZoomAll()">
            <span>ğŸ”</span> åˆ‡æ¢æ‰€æœ‰å›¾ç‰‡ç¼©æ”¾
        </button>
        <button class="btn btn-rotate" onclick="rotateAll()">
            <span>ğŸ”„</span> æ—‹è½¬æ‰€æœ‰å›¾ç‰‡
        </button>
        <button class="btn btn-reset" onclick="resetAll()">
            <span>â†º</span> é‡ç½®æ‰€æœ‰å›¾ç‰‡
        </button>
        <button class="btn btn-rotate" onclick="toggleContinuousRotation()">
            <span>ğŸ”„</span> è¿ç»­æ—‹è½¬
        </button>
    </div>

    <h2>æ“ä½œè¯´æ˜</h2>

    <div class="instructions">
        <h3>ğŸ“‹ äº¤äº’æŒ‡å—</h3>
        <ul>
            <li><strong>å•å‡»å›¾ç‰‡</strong>ï¼šæ”¾å¤§/ç¼©å°å›¾ç‰‡</li>
            <li><strong>åŒå‡»å›¾ç‰‡</strong>ï¼šé¡ºæ—¶é’ˆæ—‹è½¬å›¾ç‰‡90åº¦ï¼ˆå¯è¿ç»­æ—‹è½¬ï¼‰</li>
            <li><strong>å³é”®ç‚¹å‡»å›¾ç‰‡</strong>ï¼šé€†æ—¶é’ˆæ—‹è½¬å›¾ç‰‡90åº¦</li>
            <li>ä½¿ç”¨ä¸Šæ–¹æ§åˆ¶æŒ‰é’®å¯æ‰¹é‡æ“ä½œæ‰€æœ‰å›¾ç‰‡</li>
            <li>"è¿ç»­æ—‹è½¬"æŒ‰é’®å¯ä½¿å›¾ç‰‡æŒç»­æ—‹è½¬</li>
        </ul>
    </div>

    <p>è¿™æ˜¯ä¸€äº›æµ‹è¯•æ–‡æœ¬ï¼Œç”¨æ¥å±•ç¤ºå›¾ç‰‡åœ¨æ–‡æ¡£æµä¸­çš„è¡¨ç°ã€‚å½“å›¾ç‰‡æ—‹è½¬æˆ–ç¼©æ”¾æ—¶ï¼Œå‘¨å›´çš„å¸ƒå±€ä¼šè‡ªåŠ¨è°ƒæ•´ã€‚</p>

    <div class="img-container">
        <img class="lz" src="https://images.unsplash.com/photo-1506744038136-46273834b3fb" alt="Mountain Landscape"
            onclick="handleImageClick(this)" ondblclick="rotateImage(this)"
            oncontextmenu="rotateImageCounterClockwise(this); return false;">
    </div>

    <p>å›¾ç‰‡ä¹‹é—´çš„æ–‡æœ¬å†…å®¹ï¼Œç”¨æ¥æµ‹è¯•æ’ç‰ˆæ•ˆæœã€‚å½“å›¾ç‰‡æ—‹è½¬æ—¶ï¼Œå®¹å™¨å¤§å°ä¼šè‡ªåŠ¨è°ƒæ•´ï¼Œç¡®ä¿æ–‡æœ¬æµæ­£ç¡®æ’åˆ—ã€‚</p>

    <div class="img-container">
        <img class="lz" src="https://images.unsplash.com/photo-1518837695005-2083093ee35b" alt="Ocean View"
            onclick="handleImageClick(this)" ondblclick="rotateImage(this)"
            oncontextmenu="rotateImageCounterClockwise(this); return false;">
    </div>

    <p>æ›´å¤šæ–‡æœ¬å†…å®¹ï¼Œè§‚å¯Ÿå›¾ç‰‡æ—‹è½¬å’Œç¼©æ”¾å¯¹æ’ç‰ˆçš„å½±å“ã€‚è¿™ä¸ªå¢å¼ºç‰ˆè§£å†³äº†æ—‹è½¬åå¸ƒå±€ä¸è·Ÿéšæ”¹å˜çš„é—®é¢˜ã€‚</p>

    <script>
        // å­˜å‚¨æ‰€æœ‰å›¾ç‰‡çš„çŠ¶æ€
        const imageStates = new Map();
        let layoutAdjusted = false;
        let continuousRotationActive = false;

        // åˆå§‹åŒ–å‡½æ•°
        function initialize() {
            const images = document.querySelectorAll('.lz');
            images.forEach(img => {
                const id = img.src;
                imageStates.set(id, {
                    rotation: 0,
                    isZoomed: false,
                    naturalWidth: img.naturalWidth,
                    naturalHeight: img.naturalHeight
                });

                // æ·»åŠ æ·¡å…¥æ•ˆæœ
                img.classList.add('fade-in');
            });

            updateStatusDisplay();
        }

        // å¤„ç†å›¾ç‰‡ç‚¹å‡»ï¼ˆç¼©æ”¾ï¼‰
        function handleImageClick(img) {
            const id = img.src;
            const state = imageStates.get(id) || { rotation: 0, isZoomed: false };

            state.isZoomed = !state.isZoomed;
            imageStates.set(id, state);

            img.classList.toggle('large');

            adjustLayout();
        }

        // æ—‹è½¬å›¾ç‰‡ï¼ˆé¡ºæ—¶é’ˆï¼‰
        function rotateImage(img) {
            // å¦‚æœè¿ç»­æ—‹è½¬æ¨¡å¼æ¿€æ´»ï¼Œåˆ™ä¸æ‰§è¡Œå•æ¬¡æ—‹è½¬
            if (continuousRotationActive) return;

            const id = img.src;
            const state = imageStates.get(id) || { rotation: 0, isZoomed: false };

            // æ›´æ–°æ—‹è½¬è§’åº¦ï¼ˆè¿ç»­å¢åŠ ï¼Œä¸é‡ç½®ï¼‰
            state.rotation += 90;
            imageStates.set(id, state);

            // åº”ç”¨æ—‹è½¬
            img.style.transform = `rotate(${state.rotation}deg)`;

            // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
            document.getElementById('rotationAngle').textContent = state.rotation + 'Â°';
            document.getElementById('currentMode').textContent = 'å›¾ç‰‡å·²æ—‹è½¬: ' + state.rotation + 'Â°';

            // è°ƒæ•´å¸ƒå±€
            adjustLayout();
        }

        // æ—‹è½¬å›¾ç‰‡ï¼ˆé€†æ—¶é’ˆï¼‰
        function rotateImageCounterClockwise(img) {
            const id = img.src;
            const state = imageStates.get(id) || { rotation: 0, isZoomed: false };

            // æ›´æ–°æ—‹è½¬è§’åº¦ï¼ˆè¿ç»­å‡å°‘ï¼‰
            state.rotation -= 90;
            imageStates.set(id, state);

            // åº”ç”¨æ—‹è½¬
            img.style.transform = `rotate(${state.rotation}deg)`;

            // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
            document.getElementById('rotationAngle').textContent = state.rotation + 'Â°';
            document.getElementById('currentMode').textContent = 'å›¾ç‰‡å·²æ—‹è½¬: ' + state.rotation + 'Â°';

            // è°ƒæ•´å¸ƒå±€
            adjustLayout();
        }

        // åˆ‡æ¢è¿ç»­æ—‹è½¬
        function toggleContinuousRotation() {
            continuousRotationActive = !continuousRotationActive;
            const images = document.querySelectorAll('.lz');

            if (continuousRotationActive) {
                // å¯åŠ¨è¿ç»­æ—‹è½¬
                images.forEach(img => {
                    img.classList.add('rotating');
                    // ä¿å­˜å½“å‰æ—‹è½¬è§’åº¦
                    const id = img.src;
                    const state = imageStates.get(id) || { rotation: 0, isZoomed: false };
                    img.style.transform = `rotate(${state.rotation}deg)`; // è®¾ç½®å½“å‰è§’åº¦
                });
                document.getElementById('currentMode').textContent = 'è¿ç»­æ—‹è½¬æ¨¡å¼';
            } else {
                // åœæ­¢è¿ç»­æ—‹è½¬
                images.forEach(img => {
                    img.classList.remove('rotating');
                    // ä¿å­˜åœæ­¢æ—¶çš„æ—‹è½¬è§’åº¦
                    const id = img.src;
                    const computedStyle = window.getComputedStyle(img);
                    const matrix = new DOMMatrixReadOnly(computedStyle.transform);
                    const angle = Math.round(Math.atan2(matrix.b, matrix.a) * (180 / Math.PI));
                    const state = imageStates.get(id) || { rotation: 0, isZoomed: false };
                    state.rotation = angle;
                    imageStates.set(id, state);
                    img.style.transform = `rotate(${angle}deg)`;
                });
                document.getElementById('currentMode').textContent = 'å·²åœæ­¢è¿ç»­æ—‹è½¬';
                document.getElementById('rotationAngle').textContent = imageStates.get(images[0].src).rotation + 'Â°';
            }
        }

        // è°ƒæ•´å¸ƒå±€ä»¥é€‚åº”å›¾ç‰‡æ—‹è½¬/ç¼©æ”¾
        function adjustLayout() {
            if (!layoutAdjusted) {
                document.body.classList.add('layout-adjusted');
                layoutAdjusted = true;
            }

            // æ ¹æ®å›¾ç‰‡çŠ¶æ€è°ƒæ•´å®¹å™¨
            const images = document.querySelectorAll('.lz');
            images.forEach(img => {
                const container = img.parentElement;
                const state = imageStates.get(img.src) || { rotation: 0, isZoomed: false };

                // æ ¹æ®æ—‹è½¬è§’åº¦è°ƒæ•´å®¹å™¨
                if (state.rotation % 180 !== 0) {
                    // é0æˆ–180åº¦æ—‹è½¬ - è°ƒæ•´å®¹å™¨å®½é«˜æ¯”
                    if (state.isZoomed) {
                        container.style.maxWidth = '90%';
                    } else {
                        container.style.maxWidth = '50%';
                    }
                } else {
                    // 0æˆ–180åº¦æ—‹è½¬ - æ¢å¤æ­£å¸¸å®½é«˜æ¯”
                    container.style.maxWidth = '';
                }
            });
        }

        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStatusDisplay() {
            // å¯ä»¥æ·»åŠ æ›´å¤šçŠ¶æ€æ›´æ–°é€»è¾‘
        }

        // æ‰¹é‡æ“ä½œå‡½æ•°
        function toggleZoomAll() {
            const images = document.querySelectorAll('.lz');
            images.forEach(img => {
                handleImageClick(img);
            });
        }

        function rotateAll() {
            const images = document.querySelectorAll('.lz');
            images.forEach(img => {
                rotateImage(img);
            });
        }

        function resetAll() {
            // åœæ­¢è¿ç»­æ—‹è½¬
            if (continuousRotationActive) {
                toggleContinuousRotation();
            }

            const images = document.querySelectorAll('.lz');
            images.forEach(img => {
                // é‡ç½®æ—‹è½¬
                const id = img.src;
                const state = imageStates.get(id) || { rotation: 0, isZoomed: false };
                state.rotation = 0;
                imageStates.set(id, state);

                // ç§»é™¤æ‰€æœ‰æ ·å¼
                img.style.transform = '';
                img.classList.remove('large', 'rotating');

                // é‡ç½®å®¹å™¨æ ·å¼
                const container = img.parentElement;
                container.style.maxWidth = '';
            });

            // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
            document.getElementById('rotationAngle').textContent = '0Â°';
            document.getElementById('zoomStatus').textContent = 'æ­£å¸¸';
            document.getElementById('currentMode').textContent = 'å·²é‡ç½®æ‰€æœ‰å›¾ç‰‡';

            // æ¢å¤å¸ƒå±€
            document.body.classList.remove('layout-adjusted');
            layoutAdjusted = false;
        }

        // åˆå§‹åŒ–
        window.onload = initialize;
    </script>
</body>

</html>